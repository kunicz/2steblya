function cart(){var t=setInterval(function(){if($(".t706__cartwin-content").length&&$('.t706 [name="otkuda-uznal-o-nas"]').length){if(!cartEnabled[site])return $(".t706").remove(),void clearInterval(t);setTimeout(function(){cartFunctions()},1e3),clearInterval(t)}},50)}function cartFunctions(){cartIconUponHeader(),cartOpen(),cartClose(),cartInputContainersClasses(),cartPromocode(),cartDelivery(),cartZakazchikNoTelegramNick(),cartZakazchikPoluchatel(),cartFormValidationTexts(),cartAdresPoluchatelya(),cartHerZnaetPoluchatelya(),cartCountItems(),cartPlusMinusItems(),cartPreventCloseOnOverlayClick(),cartErrorsMessageOnClick(),cartImportantFields(),cartRequiredFields(),cartYaCounterId(),cartSetCookies(),cartUseCookies(),cartHideOtkudaUznal(),cartSuccess()}function cartDynamicFunctions(){cartProductOptionsInOneLine(),cartOtsluniavit(),cartOnlyOneFromVitrina(),cartDonat(),cartPromocodeTovars(),cartShow()}function cartOpen(){$("body").on("click",".t706__carticon-wrapper,.t-store__prod-popup__btn",function(){setTimeout(function(){cartDynamicFunctions()},250)})}function cartClose(){$("body").on("click",".t706__close",function(){cartHide()})}function cartShow(){$(".t706__cartwin-content").fadeIn()}function cartHide(){$(".t706__cartwin-content").hide()}function cartInputContainersClasses(){$(".t706 .t-input-group").find("input,textarea,select").each(function(){var t=$(this).attr("name");$(this).parents(".t-input-group").attr("id",t.replace("tildaspec-mask-",""))})}function cartCountItems(){var t;setInterval(function(){var e=$(".t706__cartwin-products > .t706__product");t!=e.length&&(cartDynamicFunctions(),t=e.length)},1)}function cartPlusMinusItems(){$(".t706").on("click",".t706__product-plus,.t706__product-minus",function(){cartDynamicFunctions()})}function cartDelivery(){function t(){function t(){c.today=new Date,c["today-0"]=new Date,c["today-0"].setHours(0,0,0,0),c["tomorrow-0"]=new Date,c["tomorrow-0"].setDate(c["today-0"].getDate()+1),c["tomorrow-0"].setHours(0,0,0,0)}t(),setInterval(function(){t()},6e4)}function e(){setInterval(function(){if(s.val()&&"____-__-__"!=s.val()&&s.val()!=c["selected-yyyy"]+"-"+(c["selected-m"]<10?"0":"")+c["selected-m"]+"-"+(c["selected-d"]<10?"0":"")+c["selected-d"]){var t=s.val().split("-");c["selected-0"]=new Date(+t[0],t[1]-1,+t[2]),c["selected-d"]=parseInt(t[2].replace(/^0/,"")),c["selected-m"]=parseInt(t[1].replace(/^0/,"")),c["selected-yyyy"]=parseInt(t[0])}},50)}function a(){function t(){o.find(".t_datepicker__selected-day").removeClass("t_datepicker__selected-day"),s.val()&&o.find('[data-picker="'+c["selected-yyyy"]+"-"+c["selected-m"]+"-"+c["selected-d"]+'"]').addClass("t_datepicker__selected-day")}function e(){$(".t706 .t_datepicker__day-cell").each(function(){var t=$(this),e=t.attr("data-picker").match(/\d{4}\-(\d{1,})\-(\d{1,})/),n=t.is(".t_datepicker__next-month")||t.is(".t_datepicker__previous-month")||t.is(".t_datepicker__day-cell--disabled");$.each(specialDatesList,function(t,r){r.d==e[2]&&r.m==e[1]&&a(r,n)})})}function a(t,e){var a=!1,n=$(".t706__product");if(n.length&&n.each(function(){var e=$(this);if(t[site].exclude.includes(getTovarInCartId(e)))a=!0;else{if(!(getTovarInCartPrice(e)>=t[site].minPrice))return a=!1,!1;a=!0}}),!a&&t[site].minPrice){var r=t[site].minPrice.toString().replace(/0{3}$/,"к"),i="";i+=t[site].exclude.length?"только товары из праздничной коллекции и ":"",i+="товары от "+r,i=$('<div class="t_datepicker__specialDate" title="'+i+'">от<br>'+r+"</div>"),e&&i.css("opacity",.4),o.find('[data-picker$="-'+t.m+"-"+t.d+'"]').hide().after(i)}}function n(){function t(){var t=Cookies.get("buytoday");if(!t)return!1;var e=new Date,a=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear(),o=CryptoJS.MD5(a+""+n+r).toString();return t==o}var e=getVitrinaTovarsIds();if(allowedTodayProducts[site].length||e.length){var a=!0,n=$(".t706__product");if(n.length){var r=[];$.each(allowedTodayProducts[site],function(t,e){r.push(e[0])}),n.each(function(){var t=getTovarInCartId($(this));if(!r.includes(t)&&!e.includes(t))return a=!1,!1}),t()&&(a=!0),a&&(c.today.getHours()>=22||$(".t706 .t_datepicker__today").removeClass("t_datepicker__day-cell--disabled"))}}}function r(){var t=getVitrinaTovarsIds();if(t.length){var e=!1,a=$(".t706__product");if(a.length&&(a.each(function(){var a=getTovarInCartId($(this));if(t.includes(a)&&Object.values(nitakoi).includes(a))return e=!0,!1}),e)){var n={"2steblya":"с ветрины только щас или завтро",staytrueflowers:"с витрины только на сегодня или на завтра"};$(".t706 .t_datepicker__day-cell").addClass("t_datepicker__day-cell--disabled"),$(".t706 .t_datepicker__today").add($(".t706 .t_datepicker__today").next()).removeClass("t_datepicker__day-cell--disabled").attr("title",n[site])}}}var o,i=!1;setInterval(function(){if(o=$(".t706 .t_datepicker__inner"),o.length)return o.is(":hidden")?(s.attr("disabled",!1),void(i=!1)):void(i||(t(),e(),n(),r(),s.attr("disabled",!0),i=!0))},50),$("body").on("click",".t706 .t_datepicker__day-cell:not(.t_datepicker__past)",function(){setTimeout(function(){s.change()},100)}),$("body").on("click",".t706 .t_datepicker__arrow",function(){i=!1}),$("body").on("change",".t706 .t_datepicker__header select",function(){i=!1}),$("body").on("click",".t706__close-button,.t706__product-del",function(){s.val("")})}function n(){function t(){c.today.getHours()>=18&&a(1)}function e(){var t=c.today.getHours(),e=$(".t706__product"),n=6;for(e.each(function(){var t=$(this);$.each(allowedTodayProducts,function(e,a){return a[0]!=getTovarInCartId(t)||(n-=a[1],!1)})}),i=1;i<=3;i++)t>=n+4*i&&a(i);a(1)}function a(t){var e=l.children("option:nth-child("+t+")");e.attr("disabled",!0),e.is(":selected")&&(e.removeAttr("selected"),e.next().attr("selected",!0))}setInterval(function(){$("#dostavka-interval").toggle(!!s.val())},100),$("body").on("change",l.selector+","+s.selector,function(){l.children("option").attr("disabled",!1),c["selected-0"]&&(c["selected-0"].toDateString()==c["tomorrow-0"].toDateString()&&t(),c["selected-0"].toDateString()==c["today-0"].toDateString()&&e())})}function r(){var t={"2steblya":["телегу","https://t.me/dva_steblya"],staytrueflowers:["телеграм","https://t.me/staytrueflowers"]},e=$("#dostavka-date .t-input-subtitle"),a=e.text().replace(t[site][0],'<a href="'+t[site][1]+'">'+t[site][0]+"</a>");e.html(a)}function o(){d.val(500)}var c={},s=$('.t706 [name="dostavka-date"]'),l=$('.t706 [name="dostavka-interval"]'),d=$('.t706 [name="dostavka-price"]');s.prop("readonly",!0),t(),e(),a(),n(),r(),o()}function cartOtsluniavit(){"2steblya"==site&&$(".t706__cartwin-prodamount-label").text("нужно отслюнявить ")}function cartDonat(){function t(){$("#florist-comment > label").text("восторги и благодарности"),$('[name="florist-comment"]').attr("placeholder","мы готовы впитывать")}function e(){if(!$('[name="dostavka-date"]').val()){var t=new Date,e={d:t.getDate()+1,m:t.getMonth()+1,y:t.getFullYear()};e.d<10&&(e.d="0"+e.d),e.m<10&&(e.m="0"+e.m),$('[name="dostavka-date"]').val(e.y+"-"+e.m+"-"+e.d)}}if("2steblya"==site){$(".t706__cartwin-content").removeClass("donat");var a=$(".t706__product");a.length&&(a.length>1||857613433221==getTovarInCartId(a.eq(0))&&($(".t706__cartwin-content").addClass("donat"),cartIncompleteRemoveRequired(),t(),e()))}}function cartZakazchikNoTelegramNick(){var t=$('[name="messenger-zakazchika"]'),e=$('<div id="messenger-zakazchika-no-telegram">нет никнейма</div>');e.insertBefore(t),e.on("click",e.selector,function(){t.val($('[name="name-zakazchika"]').val()||"нет никнейма")})}function cartZakazchikPoluchatel(){var t=$('.t706 [name="name-poluchatelya"]'),e=$('.t706 [name="phone-poluchatelya"]');$("#name-poluchatelya,#phone-poluchatelya,#phone-poluchatelya + div").wrapAll("<div />").wrapAll('<div id="poluchatelData" />');var a,n=$('.t706 [name="name-zakazchika"]'),r=$('.t706 [name="phone-zakazchika"]'),o=['<div class="t-input-group t-input-group_cb unimportant">','<label class="t-checkbox__control t-text t-text_xs">','<input type="checkbox" class="t-checkbox js-tilda-rule">','<div class="t-checkbox__indicator"></div>',"получать буду я","</label>","</div>"],i=$(o.join(""));i.insertBefore("#poluchatelData"),i.on("change","input",function(){$("#poluchatelData").toggle(!$(this).is(":checked")),$(this).is(":checked")?a=setInterval(function(){t.val(n.val()),e.val(r.val())},50):(t.val(""),e.val(""),clearInterval(a))})}function cartImportantFields(){if(!cartExpanded[site]){var t={"2steblya":["чтобы не мурыжить тебя в телеге, лучше","заполнить всю инфу сразу"],staytrueflowers:["чтобы нам не пришлось потревожить вас в телеграме, лучше","указать дополнительные данные"]},e=$("#dostavka-interval");e.nextAll().not(":last").hide();var a=['<div class="t-input-group t-input-group_cb" id="unimportantTrigger">','<div class="t-input-title t-descr t-descr_md">'+t[site][0]+"</div>",'<label class="t-checkbox__control t-text t-text_xs" style="padding:10px 0">','<input type="checkbox" class="t-checkbox js-tilda-rule">','<div class="t-checkbox__indicator"></div>',t[site][1],"</label>","</div>"],n=$(a.join(""));n.insertAfter(e),n.on("change","input",function(){cartIncompleteRemoveRequired(),n.nextAll().not(":last").toggle($(this).is(":checked")),$("#unimportantTrigger").remove()})}}function cartRequiredFields(){if(cartExpanded[site]){var t=['.t706 [name="dostavka-interval"]','.t706 [name="name-poluchatelya"]','.t706 [name="phone-poluchatelya"]','.t706 [name="adres-poluchatelya-street"]','.t706 [name="adres-poluchatelya-dom"]'];$(t.join(",")).attr("data-tilda-req",1),cartIncompleteRemoveRequired()}}function cartFormValidationTexts(){var t={"2steblya":["ну не-е-е-е...","скинь телефончик, а?","а куда фотку букета выслать?","ты календарь... переверни...","а вдруг разбудим?"],staytrueflowers:["пожалуйста, укажите ваше имя","пожалуйста, укажите ваш номер телефона","пожалуйста, укажите ваш ник в телеграм","пожалуйста, укажите дату доставки","пожалуйста, укажите интервал доставки"]};formValidationTexts($(".t706__orderform"),t[site])}function cartAdresPoluchatelya(){function t(){$.each(a,function(t,e){n[e]=$('.t706 [name="adres-poluchatelya-'+e+'"]'),["city","street"].includes(e)||r.push("#adres-poluchatelya-"+e)})}function e(){$(r.join(",")).wrapAll('<div id="adresDataSmall" />').wrapAll("<div />"),$("#adres-poluchatelya-street,#adresDataSmall,#courier-comment").wrapAll("<div />").wrapAll('<div id="adresData" />')}var a=["city","street","dom","kvartira","korpus","stroenie","podezd","etazh","domofon"],n={},r=[];t(),e()}function cartHerZnaetPoluchatelya(){var t=$('.t706 [name="uznat-adres-u-poluchatelya"]');cartExpanded[site]?$("#uznat-adres-u-poluchatelya").remove():t.on("change",function(){$("#adresData").toggle(!$(this).is(":checked")),$('.t706 [name="courier-comment"]').val("").trigger("change"),$(".t706 .adresInput").each(function(){$(this).val("")})})}function cartProductOptionsInOneLine(){var t=$(".t706__product-title__option div");t.each(function(){var t=$(this).text().split(/\s*:\s*/);switch(t[0]){case"накинуть косарь":case"накинуть пятихатку":case"накинуть сотен":case"эвкалипт ннада":case"добавить 1000":case"добавить 500":case"добавить 100":$(this).hide();break;case"выебри карточку":case"карточка":t[1]=t[1].replace("со своим","с вашим")}$(this).text(t[1])})}function cartPreventCloseOnOverlayClick(){var t=$(".t706__cartwin"),e=$('<div class="t706__cartwin-overlay"></div>');t.append(e),t.on("scroll",function(){e.css("top",$(this).scrollTop()+"px")})}function cartErrorsMessageOnClick(){var t,e,a=$(".t706__cartwin .t-submit"),n=a.text();a.on("click",function(){clearTimeout(t),clearTimeout(e),a.text("..."),t=setTimeout(function(){var t=$(".t706 .js-error-control-box"),r=[];if($.each(t,function(){var t=$(this).find(".t-input-title").text().trim();t&&r.push(t)}),r.length||1!=t.length||cartExpanded[site]){var o,i={"2steblya":"ЧТО-ТО НЕ ТОГО. ПЕРЕПРОВЕРЬ!",staytrueflowers:"ФОРМА СОДЕРЖИТ ОШИБКИ"};cartExpanded[site]?(o=3e3,a.text(i[site])):(o=6e3,a.html(i[site]+'<br><span class="errorsDescription">'+r.join(" / ")+"</span>")),e=setTimeout(function(){a.text(n)},o)}else cartFormIncomplete(),a.text(n)},400)})}function cartFormIncomplete(){cartIncompleteRemoveRequired();var t=$('[data-tooltip-hook="#popup:cartIncomplete"]');t.show().animate({opacity:1},"fast",function(){window.dispatchEvent(new Event("resize"))}),t.find(".t390__btn-wrapper a:nth-child(2)").on("click",function(t){t.preventDefault(),$(".t706__cartwin .t-submit").trigger("click")}),t.find(".t390__btn-wrapper a:nth-child(1)").on("click",function(e){e.preventDefault(),$("#unimportantTrigger input").trigger("click"),$("#unimportantTrigger").remove(),t.find(".t-popup__close").trigger("click")})}function cartIncompleteRemoveRequired(){var t={"2steblya":"1675967313188",staytrueflowers:""};$('.t706 [data-input-lid="'+t[site]+'"] input').removeAttr("data-tilda-req")}function cartYaCounterId(){setTimeout(function(){var t;switch(site){case"2steblya":"undefined"!=typeof yaCounter89315640&&(t=yaCounter89315640);break;case"staytrueflowers":"undefined"!=typeof yaCounter85909890&&(t=yaCounter85909890)}t&&$('.t706 [name="ya-client-id"]').val(t.getClientID())},3e3)}function cartIconUponHeader(){if("2steblya"==site&&!(document.location.href.indexOf("tproduct")>-1)&&$(window).width()>980&&$(window).width()<1370){var t=$(".t706__carticon"),e=110;setInterval(function(){t.toggleClass("uponHeader",$(window).scrollTop()<=e)},50)}}function cartOnlyOneFromVitrina(){var t=getVitrinaTovarsIds();if(t.length){var e=$(".t706__product");e.length&&e.each(function(){var e=getTovarInCartId($(this));t.includes(e)&&e!=nitakoi[site]&&$(this).children(".t706__product-plusminus").empty()})}}function cartPromocodeTovars(){if("all"!=promocodeType[site]){var t=!1,e=$(".t706__product");if(e.each(function(){if(promocodeTovars[site].includes(getTovarInCartId($(this))))return t=!0,!1}),$("#promocode > div").toggle(t),promocodeApplied.length)if(promocodeApplied.length&&t){var a=$(".t706__cartwin-prodamount-wrap .t706__cartwin-prodamount-price"),n=parseInt(a.text().replace(" ",""));a.text((n-promocodeApplied[0]).toString().replace(/\B(?=(\d{3})+(?!\d))/g," "))}else;}}function cartPromocode(){var t=$(".t-inputpromocode__wrapper");t.parents(".t-input-group").wrap('<div id="promocode"></div>'),$(".t-form__submit button").on("click",function(){setTimeout(function(){if(!t.find(".t-text").length&&t.siblings(".t-input-error").length&&"2steblya"==site){if(!t.find("input").val())return;t.siblings(".t-input-error").text("применяй или удаляй").show()}},500)}),$(".t706 .t-inputpromocode__btn").on("click",function(){setTimeout(function(){if(!$(".t706 .t-inputpromocode__btn").length){var e=$(".t706__cartwin-prodamount-wrap .t706__cartwin-prodamount-price"),a=parseInt(e.text().replace(" ","")),n=parseInt(t.find(".t706__cartwin-prodamount-price").text());e.text((a-n).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")),"2steblya"==site&&t.find(".t-text").addClass("showed").html($(".t-inputpromocode__wrapper .t-text").html().replace("Ваша","твоя").replace("Промокод","промокод").replace(".","")),promocodeApplied.push(n)}},500)})}function cartSetCookies(){function t(t,e){var a=[];$.each(e,function(t,e){a.push("#"+e+" input")}),$("body").on("change",a.join(),function(){if($(this).val()){var n={};$.each(e,function(t,e){n[e]=$(a[t]).val()}),Cookies.set(t,JSON.stringify(n),{expires:365})}})}t("zakazchik",["name-zakazchika","phone-zakazchika","messenger-zakazchika"]),t("adres-poluchatelya",["adres-poluchatelya-street","adres-poluchatelya-dom","adres-poluchatelya-kvartira","adres-poluchatelya-korpus","adres-poluchatelya-stroenie","adres-poluchatelya-podezd","adres-poluchatelya-etazh","adres-poluchatelya-domofon","courier-comment","adres-poluchatelya-city"])}function cartUseCookies(){function t(t,e,a,n){var r=Cookies.get(t);if(r){r=JSON.parse(r);for(var o=Object.values(r),i=0;i<a.length;i++)if(!o[a[i]])return;var c=$('<a class="cartUseCookieBtn">'+n+"</a>");$("#"+e[0]).append(c),c.on("click",function(t){t.preventDefault(),$(this).hide(),$.each(e,function(t,a){$("#"+e[t]+" input").val(o[t]).change()})})}}t("zakazchik",["name-zakazchika","phone-zakazchika","messenger-zakazchika"],[0,1],"вспомнить меня"),t("adres-poluchatelya",["adres-poluchatelya-street","adres-poluchatelya-dom","adres-poluchatelya-kvartira","adres-poluchatelya-korpus","adres-poluchatelya-stroenie","adres-poluchatelya-podezd","adres-poluchatelya-etazh","adres-poluchatelya-domofon","courier-comment","adres-poluchatelya-city"],[0,1],"как в прошлый раз")}function cartHideOtkudaUznal(){var t=Cookies.get("zakazchik");t&&$("#otkuda-uznal-o-nas").remove()}function cartSuccess(){var t=$(".t706 .js-successbox"),e={"2steblya":'заказ оформлен успешно, но похоже Юкасса тупит и не хочет, штоб твои денюжки потекли к нам рекой<br><br>напиши нам в <a href="https://t.me/dva_steblya">телегу</a>, расскажи, что вот такая оказия случилась, и мы скинем тебе новую нормальную ссыклу на оплат очку',staytrueflowers:'Ваш заказ оформлен, но мы не смогли перенаправить вас на оплату заказа в Юкассе.<br><br>Напишите нам в <a href="https://t.me/staytrueflowers">телеграм</a>, и мы вышлем вам новую рабочую ссылку на оплату.'};t.addClass("hidden").attr("data-success-message",e[site]),$(".t706 form").on("tildaform:aftersuccess",function(){setTimeout(function(){t.removeClass("hidden")},3e3)})}function getTovarInCartId(t){return parseInt(t.find(".t706__product-title a").attr("href").match(/\d{12}/))}function getTovarInCartPrice(t){return parseInt(t.find(".t706__cartwin-prodamount-price").text().replace(/[^\d]/,""))}var promocodeApplied=[];